<%= render 'account/shared/page' do |page| %>
  <% page.title "Locations Map" %>
  <% page.description "View all locations on a map" %>
  
  <% page.body do %>
    <%= cable_ready_updates_for @locations do %>
      <div class="bg-white shadow overflow-hidden sm:rounded-lg">
        <div class="px-4 py-5 sm:p-6">
          <div class="mb-4">
            <label for="location-type-filter" class="block text-sm font-medium text-gray-700">Filter by Type</label>
            <select id="location-type-filter" 
                    data-action="change->bullet-train--fields--geojson--map-view#filterByType" 
                    data-bullet-train--fields--geojson--map-view-target="filter" 
                    class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md">
              <option value="">All Types</option>
              <option value="office">Office</option>
              <option value="warehouse">Warehouse</option>
              <option value="store">Store</option>
              <option value="other">Other</option>
            </select>
          </div>
          
          <div data-controller="bullet-train--fields--geojson--map-view" 
               data-bullet-train--fields--geojson--map-view-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>"
               data-bullet-train--fields--geojson--map-view-locations-url-value="<%= api_v1_team_locations_path(@team) %>">
            <div class="map-container" 
                 data-bullet-train--fields--geojson--map-view-target="container" 
                 style="height: 600px; border-radius: 0.375rem;"></div>
          </div>
        </div>
      </div>
    <% end %>
  <% end %>
  
  <% page.actions do %>
    <%= link_to "Back to Locations", [:account, @team, :locations], class: "button" %>
  <% end %>
<% end %>